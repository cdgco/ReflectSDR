<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>ReflectSDR</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.cyan-light_blue.min.css">
        <link rel="stylesheet" href="styles.css">
    </head>
    
    <body class="vsc-initialized">
        <div class="mdl-layout__container">
            <div class="demo-layout mdl-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
                <div class="mdl-layout__drawer mdl-color--blue-grey-900 mdl-color-text--blue-grey-50">
                <nav class="demo-navigation mdl-navigation mdl-color--blue-grey-800">
                  <a class="mdl-navigation__link" href=""><i class="mdl-color-text--blue-grey-400 material-icons">home</i>Home</a>
                </nav>
            </div>
            <main class="mdl-layout__content mdl-color--grey-100">
                <div class="mdl-grid">
                      <div class="mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
                           <center class="mdl-cell mdl-cell--12-col mdl-cell--12-col-desktop"> 
                                <div>
                                    <h2 style="color:#37474f;font-weight:500;">ReflectSDR</h2>
                                </div>
                            </center>
                        </div>
                          <div class="mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
                           <div class="mdl-cell mdl-cell--12-col mdl-cell--12-col-desktop"> 
                              <div style="color:#37474f">
                                    <center><h3>Directions</h3>
                                    <ol style="width:fit-content;text-align: left">
                                        <li>Plug in RTL-SDR dongle</li>
                                        <li>Click the "Connect" button</li>
                                        <li>Click on your device from the pop-up</li>
                                        <li>Click the connect button in the pop-up window</li>
                                    </ol></center>
                                </div>
                              </div>
                        </div>
                        <div class="mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
                           <center class="mdl-cell mdl-cell--12-col mdl-cell--12-col-desktop">
                               <button id="connect" class="mdl-button mdl-button--raised mdl-button--accent;" style="background-color:#78909c ;color:white;">Connect</button> 
                                <div id="info" style="display:none">
                                    <p style="margin-top: 16px;">
                                        Manufacturer ID: <span id="1"></span>    <br> 
                                        Product ID: <span id="2"></span>  <br> 
                                        Product Version: <span id="4"></span>  <br>   
                                        USB Version: <span id="5"></span>    <br> 
                                        Device Class: <span id="6"></span>    <br> 
                                        Device Protocol: <span id="3"></span>  <br> 
                                    </p>  
                                </div>
                            </center>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </body>
    <script>
        let connectButton = document.querySelector("#connect");
        connectButton.addEventListener('click', async function() {
            var device;


            navigator.usb.requestDevice({ filters: [{ 'vendorId': 3034, 'productId': 10296 }] })
            .then(selectedDevice => {
               device = selectedDevice;
               return device.open(); // Begin a session.
             })
            .then(() => device.selectConfiguration(1)) // Select configuration #1 for the device.
            .then(() => device.claimInterface(0)) // Request exclusive control over interface #2.
            .then(() => device.selectAlternateInterface(0, 0))
            .then(() => {

                document.getElementById("info").style.display = "block";
                            document.getElementById("1").innerHTML = device.vendorId;
                            document.getElementById("2").innerHTML = device.productId;
                            document.getElementById("3").innerHTML = device.deviceProtocol; 
                            document.getElementById("4").innerHTML = device.deviceVersionMajor + "." + device.deviceVersionMinor + "." + device.deviceVersionSubminor;
                            document.getElementById("5").innerHTML = device.usbVersionMajor + "." + device.usbVersionMinor + "." + device.usbVersionSubminor;
                            document.getElementById("6").innerHTML = device.deviceClass + "." + device.deviceSubclass;
                            document.getElementById("connect").style.display = "none";

                        })
            .then(() => device.controlTransferIn({
                    requestType:'standard',recipient:'interface',request: 0,value: 1,index: 0
             }, 2))
            .then(result => { console.log(result.data); })
            .then(() => device.controlTransferIn({
                    requestType:'standard',recipient:'interface',request: 8,value: 1,index: 0
             }, 2))
            .then(result => { console.log(result.data); })
            .then(() => device.controlTransferIn({
                    requestType:'standard',recipient:'interface',request: 10,value: 1,index: 0
             }, 2))
            .then(result => { console.log(result.data); })
            .then(() => device.controlTransferIn({
                    requestType:'standard',recipient:'interface',request: 0,value: 1,index: 0
             }, 2))
            .then(() => { let SDRStream = device.transferIn(1, 512); 
                        if(SDRStream) { console.log("Stream Started"); }})

            });
    </script>
</html>
